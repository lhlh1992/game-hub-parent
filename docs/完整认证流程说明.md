# å®Œæ•´è®¤è¯æµç¨‹è¯´æ˜

## åœºæ™¯ï¼šç”¨æˆ·åœ¨æµè§ˆå™¨è¾“å…¥ `http://localhost:8080/game-service`

---

## ğŸ“ ç¬¬ä¸€æ­¥ï¼šGateway æ¥æ”¶è¯·æ±‚

**è¯·æ±‚åˆ°è¾¾ï¼š** `GET http://localhost:8080/game-service`

**Gateway è·¯ç”±åŒ¹é…æ£€æŸ¥ï¼š**
```yaml
# application.yml ç¬¬ 36-42 è¡Œ
routes:
  - id: game-service
    predicates:
      - Path=/game-service/**
```

**åŒ¹é…ç»“æœï¼š** âŒ **ä¸åŒ¹é…**
- `/game-service` ä¸åŒ¹é… `/game-service/**`ï¼ˆå› ä¸º `/**` éœ€è¦è‡³å°‘ä¸€ä¸ªè·¯å¾„æ®µï¼‰
- **ç»“æœï¼šè¿”å› 404**

> âš ï¸ **æ³¨æ„**ï¼šç”¨æˆ·åº”è¯¥è®¿é—® `/game-service/lobby.html`ï¼Œè€Œä¸æ˜¯æ ¹è·¯å¾„

---

## ğŸ“ æ­£ç¡®åœºæ™¯ï¼šè®¿é—® `http://localhost:8080/game-service/lobby.html`

### ç¬¬ä¸€æ­¥ï¼šGateway è·¯ç”±åŒ¹é…

**è¯·æ±‚ï¼š** `GET http://localhost:8080/game-service/lobby.html`

**è·¯ç”±åŒ¹é…ï¼š**
```yaml
# application.yml ç¬¬ 40 è¡Œ
- Path=/game-service/**
```
âœ… **åŒ¹é…æˆåŠŸï¼**

**åº”ç”¨è¿‡æ»¤å™¨ï¼š**
```yaml
# application.yml ç¬¬ 42 è¡Œ
- StripPrefix=1
```
- åŸå§‹è·¯å¾„ï¼š`/game-service/lobby.html`
- å»æ‰ç¬¬ä¸€ä¸ªè·¯å¾„æ®µåï¼š`/lobby.html`
- **è½¬å‘åˆ°ï¼š** `http://localhost:8081/lobby.html`

---

### ç¬¬äºŒæ­¥ï¼šSpring Security æƒé™æ£€æŸ¥

**æ£€æŸ¥ç‚¹ï¼š** `SecurityConfig.java` ç¬¬ 14-24 è¡Œ

```java
.authorizeExchange(ex -> ex
    .pathMatchers("/", "/actuator/**").permitAll()
    .pathMatchers("/oauth2/**", "/login/**").permitAll()
    // ğŸ‘‡ å…³é”®ï¼šé™æ€èµ„æºæ”¾è¡Œ
    .pathMatchers("/game-service/*.html", "/game-service/css/**", 
                  "/game-service/js/**", "/game-service/static/**").permitAll()
    .pathMatchers("/token").authenticated()
    .anyExchange().authenticated()
)
```

**åŒ¹é…ç»“æœï¼š** âœ… **æ”¾è¡Œ**
- `/game-service/lobby.html` åŒ¹é… `/game-service/*.html`
- **ä¸éœ€è¦è®¤è¯ï¼Œç›´æ¥æ”¾è¡Œ**

**è¯·æ±‚ç»§ç»­æµè½¬åˆ°ï¼š** `http://localhost:8081/lobby.html`

---

### ç¬¬ä¸‰æ­¥ï¼šgame-service è¿”å›é¡µé¢

**game-service å¤„ç†ï¼š**
- è¿”å› `lobby.html` æ–‡ä»¶å†…å®¹ï¼ˆé™æ€èµ„æºï¼‰
- HTML ä¸­åŒ…å«ï¼š
  ```html
  <script src="/game-service/js/auth.js"></script>
  <script src="/game-service/js/api.js"></script>
  ```

---

### ç¬¬å››æ­¥ï¼šæµè§ˆå™¨åŠ è½½ JavaScript

**é¡µé¢åŠ è½½å®Œæˆåï¼š** `lobby.html` ç¬¬ 80 è¡Œ

```javascript
document.addEventListener('DOMContentLoaded', async () => {
    // ç¡®ä¿ç”¨æˆ·å·²ç™»å½•
    currentToken = await ensureAuthenticated();  // ğŸ‘ˆ å…³é”®è°ƒç”¨
    // ...
});
```

---

### ç¬¬äº”æ­¥ï¼šè°ƒç”¨ `ensureAuthenticated()`

**ä»£ç ä½ç½®ï¼š** `auth.js` ç¬¬ 119-149 è¡Œ

```javascript
async function ensureAuthenticated() {
    // 1. å…ˆå°è¯•ä» Gateway è·å–æœ€æ–°çš„ token
    let token = await getTokenFromGateway();  // ğŸ‘ˆ ç¬¬ä¸€æ¬¡è°ƒç”¨
    
    if (token) {
        const isValid = await validateToken(token);
        if (isValid) {
            return token;  // âœ… æœ‰æœ‰æ•ˆ tokenï¼Œç›´æ¥è¿”å›
        }
    }
    
    // 2. æ£€æŸ¥ localStorage ä¸­çš„ç¼“å­˜ token
    token = getToken();
    if (token) {
        const isValid = await validateToken(token);
        if (isValid) {
            return token;  // âœ… ç¼“å­˜æœ‰æ•ˆï¼Œç›´æ¥è¿”å›
        }
    }
    
    // 3. æ²¡æœ‰ token æˆ– token æ— æ•ˆï¼Œè§¦å‘ç™»å½•
    token = await initAndLogin();  // ğŸ‘ˆ è§¦å‘ç™»å½•æµç¨‹
    return token;
}
```

**ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼š** `getTokenFromGateway()`ï¼ˆç¬¬ 16-44 è¡Œï¼‰

---

### ç¬¬å…­æ­¥ï¼šè°ƒç”¨ `/token` ç«¯ç‚¹

**è¯·æ±‚ï¼š** `GET http://localhost:8080/token`
```javascript
// auth.js ç¬¬ 18-20 è¡Œ
const res = await fetch(GATEWAY_TOKEN_URL, {
    credentials: 'include'  // åŒ…å« cookiesï¼ˆsessionï¼‰
});
```

**Gateway è·¯ç”±åŒ¹é…ï¼š**
- ä¸åŒ¹é… `/game-service/**`ï¼Œæ‰€ä»¥ä¸ä¼šè½¬å‘åˆ° game-service
- Gateway è‡ªå·±å¤„ç†è¿™ä¸ªè¯·æ±‚

**Spring Security æƒé™æ£€æŸ¥ï¼š**
```java
// SecurityConfig.java ç¬¬ 23 è¡Œ
.pathMatchers("/token").authenticated()
```
âš ï¸ **éœ€è¦è®¤è¯ï¼**

**å½“å‰çŠ¶æ€ï¼š** ç”¨æˆ·å°šæœªç™»å½•ï¼ˆæ²¡æœ‰ sessionï¼‰
- Spring Security æ‹¦æˆªè¯·æ±‚
- è¿”å› 401 Unauthorized

**å‰ç«¯å¤„ç†ï¼š** `auth.js` ç¬¬ 23-24 è¡Œ
```javascript
if (res.status === 401) {
    return null;  // æœªç™»å½•
}
```

**ç»§ç»­æ‰§è¡Œï¼š** `ensureAuthenticated()` ä¸­ï¼Œå› ä¸º `token` ä¸º `null`ï¼Œè¿›å…¥ `initAndLogin()`

---

### ç¬¬ä¸ƒæ­¥ï¼šè§¦å‘ OAuth2 ç™»å½•

**ä»£ç ï¼š** `auth.js` ç¬¬ 51-68 è¡Œ

```javascript
async function initAndLogin() {
    // å…ˆå°è¯•ä» Gateway è·å– token
    let token = await getTokenFromGateway();
    
    if (token) {
        return token;  // å·²ç™»å½•ï¼Œç›´æ¥è¿”å›
    }
    
    // å¦‚æœæ²¡æœ‰ tokenï¼Œè·³è½¬åˆ° Gateway çš„ OAuth2 ç™»å½•
    console.log('æœªç™»å½•ï¼Œè·³è½¬åˆ° Gateway OAuth2 ç™»å½•...');
    const currentUrl = window.location.href;
    // ğŸ‘‡ å…³é”®ï¼šè·³è½¬åˆ° Gateway çš„ OAuth2 ç™»å½•ç«¯ç‚¹
    window.location.href = GATEWAY_LOGIN_URL + '?redirect_uri=' + encodeURIComponent(currentUrl);
    // GATEWAY_LOGIN_URL = '/oauth2/authorization/keycloak'
}
```

**æµè§ˆå™¨è·³è½¬ï¼š** `http://localhost:8080/oauth2/authorization/keycloak?redirect_uri=...`

---

### ç¬¬å…«æ­¥ï¼šGateway å¤„ç† OAuth2 ç™»å½•è¯·æ±‚

**è¯·æ±‚ï¼š** `GET http://localhost:8080/oauth2/authorization/keycloak`

**Spring Security æƒé™æ£€æŸ¥ï¼š**
```java
// SecurityConfig.java ç¬¬ 18 è¡Œ
.pathMatchers("/oauth2/**", "/login/**").permitAll()
```
âœ… **æ”¾è¡Œ**ï¼ˆä¸éœ€è¦è®¤è¯ï¼‰

**Spring Security OAuth2 å®¢æˆ·ç«¯å¤„ç†ï¼š**
- è¿™æ˜¯ Spring Security çš„ OAuth2 ç™»å½•ç«¯ç‚¹
- æ ¹æ® `application.yml` é…ç½®ï¼š
  ```yaml
  # ç¬¬ 16-23 è¡Œ
  registration:
    keycloak:
      client-id: game-hub
      client-secret: Lt2kkFyWYjJAEBNd7ZAk3TQTjMkj89iZ
      authorization-grant-type: authorization_code
      redirect-uri: "{baseUrl}/login/oauth2/code/{registrationId}"
      # ä¼šç”Ÿæˆ: http://localhost:8080/login/oauth2/code/keycloak
  ```

**Gateway æ„å»ºæˆæƒ URLï¼š**
```
http://127.0.0.1:8180/realms/my-realm/protocol/openid-connect/auth?
  response_type=code&
  client_id=game-hub&
  scope=openid profile email roles&
  state=xxx&
  redirect_uri=http://localhost:8080/login/oauth2/code/keycloak
```

**æµè§ˆå™¨é‡å®šå‘åˆ°ï¼š** Keycloak ç™»å½•é¡µé¢

---

### ç¬¬ä¹æ­¥ï¼šç”¨æˆ·åœ¨ Keycloak ç™»å½•

**ç”¨æˆ·æ“ä½œï¼š**
1. åœ¨ Keycloak ç™»å½•é¡µé¢è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
2. ç‚¹å‡»ç™»å½•

**Keycloak å¤„ç†ï¼š**
1. éªŒè¯ç”¨æˆ·å‡­è¯
2. æ£€æŸ¥ `redirect_uri` æ˜¯å¦åœ¨å®¢æˆ·ç«¯çš„ "Valid redirect URIs" ä¸­ âœ…
3. ç”Ÿæˆæˆæƒç ï¼ˆauthorization codeï¼‰
4. é‡å®šå‘å› Gateway

**é‡å®šå‘ URLï¼š**
```
http://localhost:8080/login/oauth2/code/keycloak?
  code=xxx&
  state=xxx
```

---

### ç¬¬åæ­¥ï¼šGateway æ¥æ”¶æˆæƒç å›è°ƒ

**è¯·æ±‚ï¼š** `GET http://localhost:8080/login/oauth2/code/keycloak?code=xxx&state=xxx`

**Spring Security æƒé™æ£€æŸ¥ï¼š**
```java
// SecurityConfig.java ç¬¬ 18 è¡Œ
.pathMatchers("/oauth2/**", "/login/**").permitAll()
```
âœ… **æ”¾è¡Œ**

**Spring Security OAuth2 å®¢æˆ·ç«¯å¤„ç†ï¼š**
1. éªŒè¯ `state` å‚æ•°ï¼ˆé˜²æ­¢ CSRF æ”»å‡»ï¼‰
2. ä½¿ç”¨æˆæƒç æ¢å– Access Token
   - è¯·æ±‚ï¼š`POST http://127.0.0.1:8180/realms/my-realm/protocol/openid-connect/token`
   - å‚æ•°ï¼š
     ```
     grant_type=authorization_code
     code=xxx
     client_id=game-hub
     client_secret=Lt2kkFyWYjJAEBNd7ZAk3TQTjMkj89iZ
     redirect_uri=http://localhost:8080/login/oauth2/code/keycloak
     ```
3. Keycloak è¿”å› Access Token
4. Spring Security ä¿å­˜ Token åˆ° Session
   - ä½¿ç”¨ `ReactiveOAuth2AuthorizedClientService` å­˜å‚¨
   - Session ID ä¿å­˜åœ¨ Cookie ä¸­

**é‡å®šå‘åˆ°åŸå§‹è¯·æ±‚ï¼š**
- Spring Security é»˜è®¤ä¼šé‡å®šå‘åˆ°ç”¨æˆ·æœ€åˆè®¿é—®çš„é¡µé¢
- å¦‚æœç”¨æˆ·è®¿é—®çš„æ˜¯ `/game-service/lobby.html`ï¼Œä¼šé‡å®šå‘å›è¿™ä¸ªé¡µé¢

---

### ç¬¬åä¸€æ­¥ï¼šç”¨æˆ·å·²ç™»å½•ï¼Œé¡µé¢é‡æ–°åŠ è½½

**æµè§ˆå™¨é‡å®šå‘ï¼š** `http://localhost:8080/game-service/lobby.html`

**é¡µé¢é‡æ–°æ‰§è¡Œï¼š** `lobby.html` ç¬¬ 80-104 è¡Œ

```javascript
document.addEventListener('DOMContentLoaded', async () => {
    currentToken = await ensureAuthenticated();  // ğŸ‘ˆ å†æ¬¡è°ƒç”¨
});
```

**å†æ¬¡è°ƒç”¨ `ensureAuthenticated()`ï¼š**
1. è°ƒç”¨ `getTokenFromGateway()` â†’ `/token`
2. è¿™æ¬¡è¯·æ±‚åŒ…å« Cookieï¼ˆSession IDï¼‰
3. Gateway çš„ `TokenController` å¤„ç†è¯·æ±‚

---

### ç¬¬åäºŒæ­¥ï¼šTokenController å¤„ç† `/token` è¯·æ±‚

**ä»£ç ä½ç½®ï¼š** `TokenController.java` ç¬¬ 33-67 è¡Œ

```java
@GetMapping("/token")
public Mono<ResponseEntity<Map<String, Object>>> getToken(Authentication authentication) {
    // 1. æ£€æŸ¥æ˜¯å¦å·²è®¤è¯
    if (authentication == null || !authentication.isAuthenticated()) {
        return 401;  // æœªç™»å½•
    }
    
    // 2. ä» Session ä¸­è·å– OAuth2 æˆæƒä¿¡æ¯
    String clientRegistrationId = "keycloak";
    String principalName = authentication.getName();
    
    return authorizedClientService.loadAuthorizedClient(clientRegistrationId, principalName)
        .map(authorizedClient -> {
            // 3. æå– Access Token
            OAuth2AccessToken accessToken = authorizedClient.getAccessToken();
            String tokenValue = accessToken.getTokenValue();
            
            // 4. è¿”å› Token ç»™å‰ç«¯
            Map<String, Object> result = new HashMap<>();
            result.put("access_token", tokenValue);
            result.put("token_type", accessToken.getTokenType().getValue());
            result.put("expires_at", accessToken.getExpiresAt().toEpochMilli());
            
            return ResponseEntity.ok(result);
        });
}
```

**TokenController çš„ä½œç”¨ï¼š**
1. âœ… ä»æœåŠ¡å™¨ç«¯ Session ä¸­è·å– OAuth2 Token
2. âœ… è¿”å›ç»™å‰ç«¯ JavaScript
3. âœ… å‰ç«¯ä¿å­˜åˆ° localStorageï¼ˆç”¨äºåç»­ API è°ƒç”¨ï¼‰

**ä¸ºä»€ä¹ˆéœ€è¦ TokenControllerï¼Ÿ**
- Gateway ä½¿ç”¨ WebFluxï¼ˆå“åº”å¼ï¼‰ï¼ŒOAuth2 Token ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ Session
- å‰ç«¯ JavaScript æ— æ³•ç›´æ¥è®¿é—®æœåŠ¡å™¨ç«¯ Session
- éœ€è¦é€šè¿‡ API ç«¯ç‚¹è·å– Token

**è¿”å›å“åº”ï¼š**
```json
{
  "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "Bearer",
  "expires_at": 1234567890
}
```

---

### ç¬¬åä¸‰æ­¥ï¼šå‰ç«¯ä¿å­˜ Token å¹¶ç»§ç»­

**å‰ç«¯å¤„ç†ï¼š** `auth.js` ç¬¬ 29-37 è¡Œ

```javascript
const data = await res.json();
const token = data.access_token;

// ä¿å­˜ token åˆ° localStorage
localStorage.setItem(TOKEN_STORAGE_KEY, token);

return token;
```

**`ensureAuthenticated()` è¿”å›ï¼š** `token`ï¼ˆå­—ç¬¦ä¸²ï¼‰

**é¡µé¢ç»§ç»­æ‰§è¡Œï¼š**
```javascript
// lobby.html ç¬¬ 84-94 è¡Œ
currentToken = await ensureAuthenticated();
console.log('ç™»å½•æˆåŠŸï¼Œtoken:', currentToken ? 'å·²è·å–' : 'æœªè·å–');

// è·å–ç”¨æˆ·ä¿¡æ¯
userInfo = await getUserInfo();
if (userInfo) {
    displayUserInfo(userInfo);
}
```

---

### ç¬¬åå››æ­¥ï¼šè°ƒç”¨ API è·å–ç”¨æˆ·ä¿¡æ¯

**ä»£ç ï¼š** `auth.js` ç¬¬ 155-172 è¡Œ

```javascript
async function getUserInfo() {
    const token = getToken();  // ä» localStorage è·å–
    if (!token) return null;
    
    try {
        const res = await fetch('/game-service/me', {
            headers: {
                'Authorization': 'Bearer ' + token  // ğŸ‘ˆ ä½¿ç”¨ Token
            }
        });
        if (res.ok) {
            return await res.json();
        }
    } catch (e) {
        console.error('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', e);
    }
    return null;
}
```

**è¯·æ±‚ï¼š** `GET http://localhost:8080/game-service/me`
- Header: `Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...`

**Gateway è·¯ç”±åŒ¹é…ï¼š**
- âœ… åŒ¹é… `/game-service/**`
- StripPrefix â†’ `/me`
- è½¬å‘åˆ°ï¼š`http://localhost:8081/me`

**Gateway çš„ TokenRelay è¿‡æ»¤å™¨ï¼š**
```yaml
# application.yml ç¬¬ 34 è¡Œ
default-filters:
  - TokenRelay
```
- TokenRelay ä¼šè‡ªåŠ¨å°†è¯·æ±‚ä¸­çš„ Token è½¬å‘åˆ°ä¸‹æ¸¸æœåŠ¡
- ä¸‹æ¸¸æœåŠ¡ï¼ˆgame-serviceï¼‰å¯ä»¥éªŒè¯ Token å¹¶è·å–ç”¨æˆ·ä¿¡æ¯

---

## ğŸ“Š å®Œæ•´æµç¨‹å›¾

```
ç”¨æˆ·è®¿é—® /game-service/lobby.html
  â†“
Gateway è·¯ç”±åŒ¹é… âœ… â†’ è½¬å‘åˆ° game-service
  â†“
Spring Security æ£€æŸ¥ â†’ é™æ€èµ„æºæ”¾è¡Œ âœ…
  â†“
è¿”å› HTML é¡µé¢
  â†“
æµè§ˆå™¨åŠ è½½ JavaScript
  â†“
è°ƒç”¨ ensureAuthenticated()
  â†“
è°ƒç”¨ getTokenFromGateway() â†’ GET /token
  â†“
Spring Security æ‹¦æˆªï¼ˆéœ€è¦è®¤è¯ï¼‰â†’ 401
  â†“
å‰ç«¯è°ƒç”¨ initAndLogin()
  â†“
è·³è½¬åˆ° /oauth2/authorization/keycloak
  â†“
Gateway æ„å»ºæˆæƒ URL â†’ é‡å®šå‘åˆ° Keycloak
  â†“
ç”¨æˆ·åœ¨ Keycloak ç™»å½•
  â†“
Keycloak è¿”å›æˆæƒç  â†’ é‡å®šå‘åˆ° /login/oauth2/code/keycloak
  â†“
Gateway ç”¨æˆæƒç æ¢å– Token â†’ ä¿å­˜åˆ° Session
  â†“
é‡å®šå‘å› /game-service/lobby.html
  â†“
é¡µé¢é‡æ–°åŠ è½½ â†’ å†æ¬¡è°ƒç”¨ ensureAuthenticated()
  â†“
è°ƒç”¨ getTokenFromGateway() â†’ GET /tokenï¼ˆåŒ…å« Cookieï¼‰
  â†“
TokenController ä» Session è·å– Token â†’ è¿”å›ç»™å‰ç«¯
  â†“
å‰ç«¯ä¿å­˜ Token åˆ° localStorage
  â†“
è°ƒç”¨ APIï¼ˆä½¿ç”¨ Tokenï¼‰â†’ è·å–ç”¨æˆ·ä¿¡æ¯
  â†“
æ˜¾ç¤ºé¡µé¢å†…å®¹
```

---

## ğŸ”‘ å…³é”®é…ç½®è¯´æ˜

### 1. Gateway è·¯ç”±é…ç½®
```yaml
routes:
  - id: game-service
    predicates:
      - Path=/game-service/**  # åŒ¹é…æ‰€æœ‰ /game-service/xxx è·¯å¾„
    filters:
      - StripPrefix=1  # å»æ‰ /game-service å‰ç¼€
```

### 2. Spring Security æƒé™é…ç½®
```java
.pathMatchers("/game-service/*.html", ...).permitAll()  // é™æ€èµ„æºæ”¾è¡Œ
.pathMatchers("/token").authenticated()  // Token ç«¯ç‚¹éœ€è¦è®¤è¯
.anyExchange().authenticated()  // å…¶ä»–è¯·æ±‚éœ€è¦è®¤è¯
```

### 3. OAuth2 å®¢æˆ·ç«¯é…ç½®
```yaml
registration:
  keycloak:
    client-id: game-hub
    redirect-uri: "{baseUrl}/login/oauth2/code/{registrationId}"
    # ç”Ÿæˆ: http://localhost:8080/login/oauth2/code/keycloak
```

### 4. TokenController çš„ä½œç”¨
- **ä¸ºä»€ä¹ˆéœ€è¦ï¼Ÿ** Gateway ä½¿ç”¨ Session å­˜å‚¨ Tokenï¼Œå‰ç«¯æ— æ³•ç›´æ¥è®¿é—®
- **åšä»€ä¹ˆï¼Ÿ** ä» Session ä¸­æå– Tokenï¼Œè¿”å›ç»™å‰ç«¯
- **ä»€ä¹ˆæ—¶å€™è°ƒç”¨ï¼Ÿ** å‰ç«¯éœ€è¦ Token æ—¶ï¼ˆAPI è°ƒç”¨ã€WebSocket è¿æ¥ï¼‰

---

## ğŸ’¡ æ€»ç»“

1. **Gateway æ˜¯ç»Ÿä¸€å…¥å£**ï¼šæ‰€æœ‰è¯·æ±‚éƒ½ç»è¿‡ Gateway
2. **Spring Security è´Ÿè´£è®¤è¯**ï¼šæ‹¦æˆªæœªè®¤è¯è¯·æ±‚ï¼Œè§¦å‘ OAuth2 ç™»å½•
3. **Keycloak æ˜¯è®¤è¯æœåŠ¡å™¨**ï¼šå¤„ç†ç”¨æˆ·ç™»å½•ï¼Œé¢å‘ Token
4. **TokenController æ˜¯æ¡¥æ¢**ï¼šå°†æœåŠ¡å™¨ç«¯ Session ä¸­çš„ Token æä¾›ç»™å‰ç«¯
5. **å‰ç«¯ä½¿ç”¨ Token**ï¼šè°ƒç”¨ APIã€å»ºç«‹ WebSocket è¿æ¥

æ•´ä¸ªæµç¨‹æ˜¯æ ‡å‡†çš„ OAuth2 æˆæƒç æµç¨‹ï¼ŒSpring Security å’Œ Gateway è‡ªåŠ¨å¤„ç†äº†å¤§éƒ¨åˆ†ç»†èŠ‚ã€‚

