# system-service é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
system-service/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ com/
â”‚   â”‚   â”‚       â””â”€â”€ gamehub/
â”‚   â”‚   â”‚           â””â”€â”€ systemservice/
â”‚   â”‚   â”‚               â”œâ”€â”€ SystemServiceApplication.java  # å¯åŠ¨ç±»
â”‚   â”‚   â”‚               â”œâ”€â”€ controller/                    # REST æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ user/                     # ç”¨æˆ·ç›¸å…³æ¥å£
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ role/                     # è§’è‰²ç›¸å…³æ¥å£
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ permission/               # æƒé™ç›¸å…³æ¥å£
â”‚   â”‚   â”‚               â”œâ”€â”€ service/                       # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ user/                     # ç”¨æˆ·ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ role/                     # è§’è‰²ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ permission/               # æƒé™ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚               â”œâ”€â”€ repository/                    # æ•°æ®è®¿é—®å±‚ï¼ˆJPA Repositoryï¼‰
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ user/                     # ç”¨æˆ· Repository
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ role/                     # è§’è‰² Repository
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ permission/               # æƒé™ Repository
â”‚   â”‚   â”‚               â”œâ”€â”€ entity/                         # JPA å®ä½“ç±»
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ user/                     # ç”¨æˆ·å®ä½“
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ role/                     # è§’è‰²å®ä½“
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ permission/               # æƒé™å®ä½“
â”‚   â”‚   â”‚               â”œâ”€â”€ dto/                           # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ request/                  # è¯·æ±‚ DTO
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ response/                  # å“åº” DTO
â”‚   â”‚   â”‚               â”œâ”€â”€ config/                       # é…ç½®ç±»
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ SecurityConfig.java      # å®‰å…¨é…ç½®
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ JpaConfig.java            # JPA é…ç½®ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ RedisConfig.java          # Redis é…ç½®ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â”‚               â”œâ”€â”€ exception/                    # å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ GlobalExceptionHandler.java  # å…¨å±€å¼‚å¸¸å¤„ç†å™¨
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ BusinessException.java    # ä¸šåŠ¡å¼‚å¸¸
â”‚   â”‚   â”‚               â””â”€â”€ common/                       # å…¬å…±ç±»
â”‚   â”‚   â”‚                   â”œâ”€â”€ Result.java                # ç»Ÿä¸€å“åº”ç»“æœ
â”‚   â”‚   â”‚                   â””â”€â”€ constants/                 # å¸¸é‡å®šä¹‰
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â””â”€â”€ application.yml                          # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ test/                                             # æµ‹è¯•ä»£ç 
â””â”€â”€ pom.xml
```

## ğŸ“‹ å„å±‚èŒè´£è¯´æ˜

### 1. Controller å±‚ï¼ˆæ§åˆ¶å™¨å±‚ï¼‰
- **èŒè´£**ï¼šæ¥æ”¶ HTTP è¯·æ±‚ï¼Œå‚æ•°æ ¡éªŒï¼Œè°ƒç”¨ Serviceï¼Œè¿”å›å“åº”
- **ç¤ºä¾‹**ï¼š`UserController`ã€`RoleController`ã€`PermissionController`
- **ç‰¹ç‚¹**ï¼š
  - ä½¿ç”¨ `@RestController` æ³¨è§£
  - ä½¿ç”¨ `@Valid` è¿›è¡Œå‚æ•°æ ¡éªŒ
  - è¿”å›ç»Ÿä¸€çš„ `Result<T>` å“åº”æ ¼å¼

### 2. Service å±‚ï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰
- **èŒè´£**ï¼šä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œäº‹åŠ¡ç®¡ç†ï¼Œè°ƒç”¨ Repository
- **ç»“æ„**ï¼šæ¥å£ + å®ç°ç±»åˆ†ç¦»
  - **æ¥å£**ï¼š`service/user/UserService.java` - å®šä¹‰æœåŠ¡æ¥å£
  - **å®ç°**ï¼š`service/impl/user/UserServiceImpl.java` - å®ç°æœåŠ¡é€»è¾‘
- **ç‰¹ç‚¹**ï¼š
  - æ¥å£å®šä¹‰åœ¨ `service/` ç›®å½•ä¸‹
  - å®ç°ç±»åœ¨ `service/impl/` ç›®å½•ä¸‹
  - å®ç°ç±»ä½¿ç”¨ `@Service` æ³¨è§£
  - ä½¿ç”¨ `@Transactional` ç®¡ç†äº‹åŠ¡
  - å¤„ç†ä¸šåŠ¡è§„åˆ™å’Œå¼‚å¸¸
- **ä¼˜åŠ¿**ï¼š
  - ä¾¿äºæµ‹è¯•ï¼ˆå¯ä»¥ Mock æ¥å£ï¼‰
  - ä¾¿äºæ‰©å±•ï¼ˆå¯ä»¥æœ‰å¤šä¸ªå®ç°ï¼‰
  - ç¬¦åˆä¾èµ–å€’ç½®åŸåˆ™

### 3. Repository å±‚ï¼ˆæ•°æ®è®¿é—®å±‚ï¼‰
- **èŒè´£**ï¼šæ•°æ®åº“æ“ä½œï¼ŒJPA Repository æ¥å£
- **ç¤ºä¾‹**ï¼š`SysUserRepository`ã€`SysRoleRepository`
- **ç‰¹ç‚¹**ï¼š
  - ç»§æ‰¿ `JpaRepository<T, ID>`
  - ä½¿ç”¨ `@Query` è‡ªå®šä¹‰æŸ¥è¯¢
  - ä½¿ç”¨ `Specification` åŠ¨æ€æŸ¥è¯¢

### 4. Entity å±‚ï¼ˆå®ä½“å±‚ï¼‰
- **èŒè´£**ï¼šJPA å®ä½“ç±»ï¼Œå¯¹åº”æ•°æ®åº“è¡¨
- **ç¤ºä¾‹**ï¼š`SysUser`ã€`SysRole`ã€`SysPermission`
- **ç‰¹ç‚¹**ï¼š
  - ä½¿ç”¨ `@Entity`ã€`@Table` æ³¨è§£
  - ä½¿ç”¨ `@Id`ã€`@GeneratedValue` å®šä¹‰ä¸»é”®
  - ä½¿ç”¨ `@ManyToMany`ã€`@OneToMany` å®šä¹‰å…³è”å…³ç³»

### 5. DTO å±‚ï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰
- **èŒè´£**ï¼šè¯·æ±‚/å“åº”å¯¹è±¡ï¼Œé¿å…ç›´æ¥æš´éœ² Entity
- **ç¤ºä¾‹**ï¼š`CreateUserRequest`ã€`UserResponse`ã€`RoleResponse`
- **ç‰¹ç‚¹**ï¼š
  - ä½¿ç”¨ `@Data`ã€`@Builder` ç­‰ Lombok æ³¨è§£
  - ä½¿ç”¨ `@Valid`ã€`@NotNull` ç­‰æ ¡éªŒæ³¨è§£

### 6. Config å±‚ï¼ˆé…ç½®å±‚ï¼‰
- **èŒè´£**ï¼šSpring é…ç½®ç±»
- **ç¤ºä¾‹**ï¼š`SecurityConfig`ã€`JpaConfig`
- **ç‰¹ç‚¹**ï¼š
  - ä½¿ç”¨ `@Configuration` æ³¨è§£
  - å®šä¹‰ Bean å’Œé…ç½®

### 7. Exception å±‚ï¼ˆå¼‚å¸¸å¤„ç†å±‚ï¼‰
- **èŒè´£**ï¼šå¼‚å¸¸å®šä¹‰å’Œå…¨å±€å¼‚å¸¸å¤„ç†
- **ç¤ºä¾‹**ï¼š`BusinessException`ã€`GlobalExceptionHandler`
- **ç‰¹ç‚¹**ï¼š
  - è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸
  - ç»Ÿä¸€å¼‚å¸¸å“åº”æ ¼å¼

### 8. Common å±‚ï¼ˆå…¬å…±å±‚ï¼‰
- **èŒè´£**ï¼šå…¬å…±å·¥å…·ç±»å’Œå¸¸é‡
- **ç¤ºä¾‹**ï¼š`Result`ã€`PageResult`ã€å¸¸é‡ç±»
- **ç‰¹ç‚¹**ï¼š
  - å¯å¤ç”¨çš„å·¥å…·ç±»
  - ç»Ÿä¸€çš„å“åº”æ ¼å¼

## ğŸ”§ æŠ€æœ¯æ ˆ

- **Web æ¡†æ¶**ï¼šSpring MVCï¼ˆ`spring-boot-starter-web`ï¼‰
- **ORM æ¡†æ¶**ï¼šHibernateï¼ˆé€šè¿‡ `spring-boot-starter-data-jpa`ï¼‰
- **æ•°æ®åº“**ï¼šPostgreSQL
- **ç¼“å­˜**ï¼šRedisï¼ˆdatabase 3ï¼‰
- **å®‰å…¨**ï¼šSpring Security + OAuth2 Resource Serverï¼ˆJWT éªŒè¯ï¼‰
- **å·¥å…·**ï¼šLombokã€Validation

## ğŸ“ å¼€å‘è§„èŒƒ

1. **å‘½åè§„èŒƒ**ï¼š
   - Controllerï¼š`XxxController`
   - Serviceï¼š`XxxService`ã€`XxxServiceImpl`
   - Repositoryï¼š`XxxRepository`
   - Entityï¼š`SysXxx`ï¼ˆå¯¹åº”æ•°æ®åº“è¡¨ï¼‰
   - DTOï¼š`XxxRequest`ã€`XxxResponse`

2. **åŒ…ç»“æ„**ï¼š
   - æŒ‰ä¸šåŠ¡æ¨¡å—åˆ’åˆ†ï¼ˆuserã€roleã€permissionï¼‰
   - æ¯ä¸ªæ¨¡å—åŒ…å«å®Œæ•´çš„ controllerã€serviceã€repositoryã€entityã€dto

3. **äº‹åŠ¡ç®¡ç†**ï¼š
   - Service å±‚æ–¹æ³•ä½¿ç”¨ `@Transactional`
   - åªè¯»æ“ä½œä½¿ç”¨ `@Transactional(readOnly = true)`

4. **å¼‚å¸¸å¤„ç†**ï¼š
   - ä¸šåŠ¡å¼‚å¸¸æŠ›å‡º `BusinessException`
   - å…¨å±€å¼‚å¸¸å¤„ç†å™¨ç»Ÿä¸€å¤„ç†

5. **å“åº”æ ¼å¼**ï¼š
   - ç»Ÿä¸€ä½¿ç”¨ `Result<T>` åŒ…è£…å“åº”
   - æˆåŠŸï¼š`Result.success(data)`
   - å¤±è´¥ï¼š`Result.error(message)`

